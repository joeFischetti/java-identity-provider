<?xml version="1.0" encoding="UTF-8"?>
<!-- This file is an EXAMPLE policy file. While the policy presented in this 
	example file is functional, it isn't very interesting. Deployers should refer 
	to the Shibboleth 2 documentation for a complete list of components and their 
	options. -->
<afp:AttributeFilterPolicyGroup id="ShibbolethFilterPolicy"
	xmlns:afp="urn:mace:shibboleth:2.0:afp" xmlns:basic="urn:mace:shibboleth:2.0:afp:mf:basic"
	xmlns:saml="urn:mace:shibboleth:2.0:afp:mf:saml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:mace:shibboleth:2.0:afp http://shibboleth.net/schema/idp/shibboleth-afp.xsd
                                                    urn:mace:shibboleth:2.0:afp:mf:basic http://shibboleth.net/schema/idp/shibboleth-afp-mf-basic.xsd
                                                    urn:mace:shibboleth:2.0:afp:mf:saml http://shibboleth.net/schema/idp/shibboleth-afp-mf-saml.xsd">

	<!-- Release OK if RA map -->
	<afp:AttributeFilterPolicy id="RAOKFILTER">
		<afp:PolicyRequirementRule id="prrRA1"
			xsi:type="basic:ANY" />

		<afp:AttributeRule attributeID="IdPRA1" id="ra1release">
			<afp:PermitValueRule xsi:type="saml:RequestedAttributeInMetadata" />
		</afp:AttributeRule>

	</afp:AttributeFilterPolicy>
	
	
    <!-- Release OK if RA map, but it doesn't -->
	<afp:AttributeFilterPolicy id="RANOTFILTER">
        <afp:PolicyRequirementRule id="prrRA2"
            xsi:type="basic:ANY" />

        <afp:AttributeRule attributeID="IdPEA1" id="ra2release">
            <afp:PermitValueRule xsi:type="saml:AttributeInMetadata" />
        </afp:AttributeRule>

    </afp:AttributeFilterPolicy>
	

    <!--  Release is EA map -->
	<afp:AttributeFilterPolicy id="EAOKFILTER">
		<afp:PolicyRequirementRule xsi:type="saml:EntityAttributeInMetadata" attributeID="IdPEA1" id="prrEA1"/>

		<afp:AttributeRule attributeID="IdPOK">
			<afp:PermitValueRule xsi:type="basic:ANY"/>
		</afp:AttributeRule>

	</afp:AttributeFilterPolicy> 

    <afp:AttributeFilterPolicy id="EANOTKFILTER">
        <afp:PolicyRequirementRule xsi:type="saml:EntityAttributeInMetadata" attributeID="IdPEA2" id="prrEA2"/>

        <afp:AttributeRule attributeID="IdPNotOK">
            <afp:PermitValueRule xsi:type="basic:ANY"/>
        </afp:AttributeRule>

    </afp:AttributeFilterPolicy> 

</afp:AttributeFilterPolicyGroup>
